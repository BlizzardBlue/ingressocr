#!/bin/sh
INGRESSPROFILE=$1
TEMPFILE=$(tempfile)
tesseract -psm 4 $INGRESSPROFILE stdout > $TEMPFILE 2>/dev/null
INGRESSUSER=$(grep -A2 AGENT $TEMPFILE | egrep "[a-z]" | tail -1 | sed -n 's/^\([A-Za-z]*\).*$/\1/p')
echo "Username $INGRESSUSER"
fgrep " AP" $TEMPFILE | sed -n 's/\([0-9].* AP\).* AP$/\1/p'
egrep "^Unique Portals Visited|\
^Portals Discovered|\
^XM Collected|\
^Hacks|\
^Resonators Deployed|\
^Links Created|\
^Control Fields Created|\
^Mind Units Captured|\
^Longest Link Ever Created|\
^Largest Control Field|\
^XM Recharged|\
^Portals Captured|\
^Unique Portals Captured|\
^Resonators Destroyed|\
^Portals Neutralized|\
^Enemy Links Destroyed|\
^Enemy Control Fields Destroyed|\
^Distance Walked|\
^Max Time Portal Held|\
^Max Time Link Maintained|\
^Max Link Length x Days|\
^Max Time Field Held|\
^Max Time Field Held|\
^Largest Field MUs x Days" \
$TEMPFILE \
| sed 's/\\\_\/ //' \
| sed 's/ <2//'
rm -f $TEMPFILE
